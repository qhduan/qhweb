<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="description" content="Web Blog - NLWEB">
  <meta name="author" content="longinus">
  <link rel="shortcut icon" href="icon.png">
  <title>Loading</title>
  <script src="js/jquery-2.1.1.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstrap-theme.min.css">
  <script src="js/util.js"></script>
</head>
<body>
<div class="container">
  <div class="page-header">
    <h1><span id="title" style="font-family: 'cursive';" ></span></h1>
	<h3 id="subtitle" style="float: right; font-family: 'cursive';"></h3>
    <a href="/" id="btn-home" class="btn btn-default">
      <span class="glyphicon glyphicon-chevron-left"></span> Home
    </a>
  </div>
  <div class="topic-content" style="font-size: 1.2em;">
    <textarea style="display: none;"></textarea>
  </div>
  <div></div>
</div>
<script>
  var path = document.URL.match(/post.html\?([0-9]+)\-([a-zA-Z0-9\+\=\/]+)$/);
  if (path) {
    var page = parseInt(path[1]);
    if (page == 1)
      $("#btn-home").attr("href", "/");
    else
      $("#btn-home").attr("href", "/?" + page);
    
    path = path[2].trim();
    try {
      path = Decode(path);
    } catch (e) {
      Alert("Something wrong with this post, press OK to return home", function () {
        window.location.href = "/";
      });
    }
    $.get(path, function (data) {
      var title = data.match(/title:\ ([^\n]+)/)[1].trim();
      var date = data.match(/date:\ ([^\n]+)/)[1].trim();
      var content = data.match(/---\n([^\0]+)/)[1].trim();
      document.title = title;
      $("#title").html(title);
      $("#subtitle").html(date);
      $(".topic-content > textarea").val(content);
      $.get("/js/editor.js", function (data) {
        eval(data);
      } ,"text")
    }, "text").fail(function () {
      Alert("Something wrong with this post, press OK to return home", function () {
        window.location.href = "/";
      });
    });
  } else {
    //window.location.href = "/";
  }
  
</script>
</body>
</html>
